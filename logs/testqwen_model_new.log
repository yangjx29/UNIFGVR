local_model_path: /home/Dataset/Models/Qwen/Qwen2.5-VL-7B-Instruct
att_shape:[13, 18]
att_flat:234
image_token_weights:234
选取值大于1的token
图像token位置范围: (15, 249)
重要stoken数量: 75
最高注意力权重: 44.8411
平均注意力权重: 4.8464
input_ids:torch.Size([1, 282])
seq_len:282
找到 image token span: img_start=14, img_end=250
[ATTN] inject Qwen attention layers with importance weights (10, 28) alpha=0.5 span=(14,250)
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 282, 3584])
hidden query_states:torch.Size([1, 282, 3584]), key_states:torch.Size([1, 282, 512]),key_states:torch.Size([1, 282, 512])
取出来的kv_seq_len:282
matmul前query_states:torch.Size([1, 28, 282, 128]), key_states:torch.Size([1, 28, 282, 128]),key_states:torch.Size([1, 28, 282, 128])
attn_weights after matmul:torch.Size([1, 28, 282, 282])
[ATTN] Initial forward pass. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:283
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 283, 128]),key_states:torch.Size([1, 28, 283, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 283])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:284
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 284, 128]),key_states:torch.Size([1, 28, 284, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 284])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:285
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 285, 128]),key_states:torch.Size([1, 28, 285, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 285])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:286
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 286, 128]),key_states:torch.Size([1, 28, 286, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 286])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:287
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 287, 128]),key_states:torch.Size([1, 28, 287, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 287])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:288
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 288, 128]),key_states:torch.Size([1, 28, 288, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 288])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:289
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 289, 128]),key_states:torch.Size([1, 28, 289, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 289])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:290
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 290, 128]),key_states:torch.Size([1, 28, 290, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 290])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:291
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 291, 128]),key_states:torch.Size([1, 28, 291, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 291])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:292
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 292, 128]),key_states:torch.Size([1, 28, 292, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 292])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:293
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 293, 128]),key_states:torch.Size([1, 28, 293, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 293])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:294
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 294, 128]),key_states:torch.Size([1, 28, 294, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 294])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:295
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 295, 128]),key_states:torch.Size([1, 28, 295, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 295])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:296
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 296, 128]),key_states:torch.Size([1, 28, 296, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 296])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:297
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 297, 128]),key_states:torch.Size([1, 28, 297, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 297])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:298
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 298, 128]),key_states:torch.Size([1, 28, 298, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 298])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:299
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 299, 128]),key_states:torch.Size([1, 28, 299, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 299])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:300
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 300, 128]),key_states:torch.Size([1, 28, 300, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 300])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:301
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 301, 128]),key_states:torch.Size([1, 28, 301, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 301])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:302
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 302, 128]),key_states:torch.Size([1, 28, 302, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 302])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:303
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 303, 128]),key_states:torch.Size([1, 28, 303, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 303])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:304
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 304, 128]),key_states:torch.Size([1, 28, 304, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 304])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:305
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 305, 128]),key_states:torch.Size([1, 28, 305, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 305])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:306
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 306, 128]),key_states:torch.Size([1, 28, 306, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 306])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:307
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 307, 128]),key_states:torch.Size([1, 28, 307, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 307])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:308
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 308, 128]),key_states:torch.Size([1, 28, 308, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 308])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:309
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 309, 128]),key_states:torch.Size([1, 28, 309, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 309])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:310
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 310, 128]),key_states:torch.Size([1, 28, 310, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 310])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:311
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 311, 128]),key_states:torch.Size([1, 28, 311, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 311])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:312
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 312, 128]),key_states:torch.Size([1, 28, 312, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 312])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:313
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 313, 128]),key_states:torch.Size([1, 28, 313, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 313])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:314
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 314, 128]),key_states:torch.Size([1, 28, 314, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 314])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:315
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 315, 128]),key_states:torch.Size([1, 28, 315, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 315])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:316
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 316, 128]),key_states:torch.Size([1, 28, 316, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 316])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:317
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 317, 128]),key_states:torch.Size([1, 28, 317, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 317])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:318
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 318, 128]),key_states:torch.Size([1, 28, 318, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 318])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:319
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 319, 128]),key_states:torch.Size([1, 28, 319, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 319])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:320
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 320, 128]),key_states:torch.Size([1, 28, 320, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 320])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:321
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 321, 128]),key_states:torch.Size([1, 28, 321, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 321])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:322
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 322, 128]),key_states:torch.Size([1, 28, 322, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 322])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:323
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 323, 128]),key_states:torch.Size([1, 28, 323, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 323])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:324
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 324, 128]),key_states:torch.Size([1, 28, 324, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 324])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:325
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 325, 128]),key_states:torch.Size([1, 28, 325, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 325])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:326
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 326, 128]),key_states:torch.Size([1, 28, 326, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 326])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:327
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 327, 128]),key_states:torch.Size([1, 28, 327, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 327])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:328
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 328, 128]),key_states:torch.Size([1, 28, 328, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 328])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:329
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 329, 128]),key_states:torch.Size([1, 28, 329, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 329])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:330
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 330, 128]),key_states:torch.Size([1, 28, 330, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 330])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:331
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 331, 128]),key_states:torch.Size([1, 28, 331, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 331])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:332
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 332, 128]),key_states:torch.Size([1, 28, 332, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 332])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:333
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 333, 128]),key_states:torch.Size([1, 28, 333, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 333])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:334
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 334, 128]),key_states:torch.Size([1, 28, 334, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 334])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:335
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 335, 128]),key_states:torch.Size([1, 28, 335, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 335])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:336
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 336, 128]),key_states:torch.Size([1, 28, 336, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 336])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:337
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 337, 128]),key_states:torch.Size([1, 28, 337, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 337])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:338
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 338, 128]),key_states:torch.Size([1, 28, 338, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 338])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:339
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 339, 128]),key_states:torch.Size([1, 28, 339, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 339])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:340
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 340, 128]),key_states:torch.Size([1, 28, 340, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 340])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:341
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 341, 128]),key_states:torch.Size([1, 28, 341, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 341])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:342
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 342, 128]),key_states:torch.Size([1, 28, 342, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 342])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:343
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 343, 128]),key_states:torch.Size([1, 28, 343, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 343])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:344
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 344, 128]),key_states:torch.Size([1, 28, 344, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 344])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:345
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 345, 128]),key_states:torch.Size([1, 28, 345, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 345])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:346
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 346, 128]),key_states:torch.Size([1, 28, 346, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 346])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:347
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 347, 128]),key_states:torch.Size([1, 28, 347, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 347])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:348
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 348, 128]),key_states:torch.Size([1, 28, 348, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 348])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:349
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 349, 128]),key_states:torch.Size([1, 28, 349, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 349])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:350
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 350, 128]),key_states:torch.Size([1, 28, 350, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 350])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:351
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 351, 128]),key_states:torch.Size([1, 28, 351, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 351])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:352
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 352, 128]),key_states:torch.Size([1, 28, 352, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 352])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:353
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 353, 128]),key_states:torch.Size([1, 28, 353, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 353])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:354
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 354, 128]),key_states:torch.Size([1, 28, 354, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 354])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:355
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 355, 128]),key_states:torch.Size([1, 28, 355, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 355])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:356
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 356, 128]),key_states:torch.Size([1, 28, 356, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 356])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:357
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 357, 128]),key_states:torch.Size([1, 28, 357, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 357])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:358
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 358, 128]),key_states:torch.Size([1, 28, 358, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 358])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:359
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 359, 128]),key_states:torch.Size([1, 28, 359, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 359])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:360
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 360, 128]),key_states:torch.Size([1, 28, 360, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 360])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:361
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 361, 128]),key_states:torch.Size([1, 28, 361, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 361])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:362
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 362, 128]),key_states:torch.Size([1, 28, 362, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 362])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:363
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 363, 128]),key_states:torch.Size([1, 28, 363, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 363])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:364
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 364, 128]),key_states:torch.Size([1, 28, 364, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 364])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:365
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 365, 128]),key_states:torch.Size([1, 28, 365, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 365])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:366
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 366, 128]),key_states:torch.Size([1, 28, 366, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 366])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:367
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 367, 128]),key_states:torch.Size([1, 28, 367, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 367])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:368
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 368, 128]),key_states:torch.Size([1, 28, 368, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 368])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:369
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 369, 128]),key_states:torch.Size([1, 28, 369, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 369])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:370
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 370, 128]),key_states:torch.Size([1, 28, 370, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 370])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:371
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 371, 128]),key_states:torch.Size([1, 28, 371, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 371])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:372
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 372, 128]),key_states:torch.Size([1, 28, 372, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 372])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:373
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 373, 128]),key_states:torch.Size([1, 28, 373, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 373])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:374
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 374, 128]),key_states:torch.Size([1, 28, 374, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 374])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:375
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 375, 128]),key_states:torch.Size([1, 28, 375, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 375])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:376
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 376, 128]),key_states:torch.Size([1, 28, 376, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 376])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:377
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 377, 128]),key_states:torch.Size([1, 28, 377, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 377])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:378
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 378, 128]),key_states:torch.Size([1, 28, 378, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 378])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:379
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 379, 128]),key_states:torch.Size([1, 28, 379, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 379])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:380
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 380, 128]),key_states:torch.Size([1, 28, 380, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 380])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:381
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 381, 128]),key_states:torch.Size([1, 28, 381, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 381])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:382
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 382, 128]),key_states:torch.Size([1, 28, 382, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 382])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:383
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 383, 128]),key_states:torch.Size([1, 28, 383, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 383])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:384
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 384, 128]),key_states:torch.Size([1, 28, 384, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 384])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:385
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 385, 128]),key_states:torch.Size([1, 28, 385, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 385])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:386
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 386, 128]),key_states:torch.Size([1, 28, 386, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 386])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:387
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 387, 128]),key_states:torch.Size([1, 28, 387, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 387])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:388
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 388, 128]),key_states:torch.Size([1, 28, 388, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 388])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:389
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 389, 128]),key_states:torch.Size([1, 28, 389, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 389])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:390
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 390, 128]),key_states:torch.Size([1, 28, 390, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 390])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:391
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 391, 128]),key_states:torch.Size([1, 28, 391, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 391])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:392
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 392, 128]),key_states:torch.Size([1, 28, 392, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 392])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:393
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 393, 128]),key_states:torch.Size([1, 28, 393, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 393])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:394
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 394, 128]),key_states:torch.Size([1, 28, 394, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 394])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:395
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 395, 128]),key_states:torch.Size([1, 28, 395, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 395])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:396
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 396, 128]),key_states:torch.Size([1, 28, 396, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 396])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:397
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 397, 128]),key_states:torch.Size([1, 28, 397, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 397])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:398
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 398, 128]),key_states:torch.Size([1, 28, 398, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 398])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:399
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 399, 128]),key_states:torch.Size([1, 28, 399, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 399])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:400
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 400, 128]),key_states:torch.Size([1, 28, 400, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 400])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:401
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 401, 128]),key_states:torch.Size([1, 28, 401, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 401])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:402
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 402, 128]),key_states:torch.Size([1, 28, 402, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 402])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:403
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 403, 128]),key_states:torch.Size([1, 28, 403, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 403])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:404
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 404, 128]),key_states:torch.Size([1, 28, 404, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 404])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:405
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 405, 128]),key_states:torch.Size([1, 28, 405, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 405])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:406
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 406, 128]),key_states:torch.Size([1, 28, 406, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 406])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:407
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 407, 128]),key_states:torch.Size([1, 28, 407, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 407])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:408
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 408, 128]),key_states:torch.Size([1, 28, 408, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 408])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:409
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 409, 128]),key_states:torch.Size([1, 28, 409, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 409])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:410
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 410, 128]),key_states:torch.Size([1, 28, 410, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 410])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:411
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 411, 128]),key_states:torch.Size([1, 28, 411, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 411])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:412
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 412, 128]),key_states:torch.Size([1, 28, 412, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 412])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:413
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 413, 128]),key_states:torch.Size([1, 28, 413, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 413])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:414
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 414, 128]),key_states:torch.Size([1, 28, 414, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 414])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:415
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 415, 128]),key_states:torch.Size([1, 28, 415, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 415])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:416
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 416, 128]),key_states:torch.Size([1, 28, 416, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 416])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:417
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 417, 128]),key_states:torch.Size([1, 28, 417, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 417])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:418
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 418, 128]),key_states:torch.Size([1, 28, 418, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 418])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:419
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 419, 128]),key_states:torch.Size([1, 28, 419, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 419])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:420
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 420, 128]),key_states:torch.Size([1, 28, 420, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 420])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:421
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 421, 128]),key_states:torch.Size([1, 28, 421, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 421])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:422
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 422, 128]),key_states:torch.Size([1, 28, 422, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 422])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:423
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 423, 128]),key_states:torch.Size([1, 28, 423, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 423])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:424
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 424, 128]),key_states:torch.Size([1, 28, 424, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 424])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:425
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 425, 128]),key_states:torch.Size([1, 28, 425, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 425])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:426
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 426, 128]),key_states:torch.Size([1, 28, 426, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 426])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
hidden_states:torch.Size([1, 1, 3584])
hidden query_states:torch.Size([1, 1, 3584]), key_states:torch.Size([1, 1, 512]),key_states:torch.Size([1, 1, 512])
取出来的kv_seq_len:427
matmul前query_states:torch.Size([1, 28, 1, 128]), key_states:torch.Size([1, 28, 427, 128]),key_states:torch.Size([1, 28, 427, 128])
attn_weights after matmul:torch.Size([1, 28, 1, 427])
[ATTN] Incremental generation mode. kv_pos_begin=15, kv_pos_end=249
[ATTN] Enhancing logits for tokens from index 15 to 249
target_weight:torch.Size([1, 28, 234])
enhancement_mask shape:torch.Size([234])
output_text: ["The dog in the image is a Weimaraner, which is identifiable by its distinctive long, silky coat, large size, and droopy ears. The dog is dressed in attire that includes a brown jacket, a hat with a spider decoration, and a leather-like collar, suggesting a costume or outfit for a specific role or event. The overall appearance, including the clothing and accessories, gives a rustic or outdoor festival vibe.\n\nWeimaraners are known for their sleek, athletic build and alert, intelligent expression. They often have a short, smooth coat that comes in various shades, including gray, blue, and silver. The dog's coloration and facial features align with those of a Weimaraner breed."]
